{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createStream = void 0;\nconst alignTableData_1 = require(\"./alignTableData\");\nconst calculateRowHeights_1 = require(\"./calculateRowHeights\");\nconst drawBorder_1 = require(\"./drawBorder\");\nconst drawRow_1 = require(\"./drawRow\");\nconst makeStreamConfig_1 = require(\"./makeStreamConfig\");\nconst mapDataUsingRowHeights_1 = require(\"./mapDataUsingRowHeights\");\nconst padTableData_1 = require(\"./padTableData\");\nconst stringifyTableData_1 = require(\"./stringifyTableData\");\nconst truncateTableData_1 = require(\"./truncateTableData\");\nconst utils_1 = require(\"./utils\");\nconst prepareData = (data, config) => {\n  let rows = (0, stringifyTableData_1.stringifyTableData)(data);\n  rows = (0, truncateTableData_1.truncateTableData)(rows, (0, utils_1.extractTruncates)(config));\n  const rowHeights = (0, calculateRowHeights_1.calculateRowHeights)(rows, config);\n  rows = (0, mapDataUsingRowHeights_1.mapDataUsingRowHeights)(rows, rowHeights, config);\n  rows = (0, alignTableData_1.alignTableData)(rows, config);\n  rows = (0, padTableData_1.padTableData)(rows, config);\n  return rows;\n};\nconst create = (row, columnWidths, config) => {\n  const rows = prepareData([row], config);\n  const body = rows.map(literalRow => {\n    return (0, drawRow_1.drawRow)(literalRow, config);\n  }).join('');\n  let output;\n  output = '';\n  output += (0, drawBorder_1.drawBorderTop)(columnWidths, config);\n  output += body;\n  output += (0, drawBorder_1.drawBorderBottom)(columnWidths, config);\n  output = output.trimEnd();\n  process.stdout.write(output);\n};\nconst append = (row, columnWidths, config) => {\n  const rows = prepareData([row], config);\n  const body = rows.map(literalRow => {\n    return (0, drawRow_1.drawRow)(literalRow, config);\n  }).join('');\n  let output = '';\n  const bottom = (0, drawBorder_1.drawBorderBottom)(columnWidths, config);\n  if (bottom !== '\\n') {\n    output = '\\r\\u001B[K';\n  }\n  output += (0, drawBorder_1.drawBorderJoin)(columnWidths, config);\n  output += body;\n  output += bottom;\n  output = output.trimEnd();\n  process.stdout.write(output);\n};\nconst createStream = userConfig => {\n  const config = (0, makeStreamConfig_1.makeStreamConfig)(userConfig);\n  const columnWidths = Object.values(config.columns).map(column => {\n    return column.width + column.paddingLeft + column.paddingRight;\n  });\n  let empty = true;\n  return {\n    write: row => {\n      if (row.length !== config.columnCount) {\n        throw new Error('Row cell count does not match the config.columnCount.');\n      }\n      if (empty) {\n        empty = false;\n        create(row, columnWidths, config);\n      } else {\n        append(row, columnWidths, config);\n      }\n    }\n  };\n};\nexports.createStream = createStream;","map":{"version":3,"names":["alignTableData_1","require","calculateRowHeights_1","drawBorder_1","drawRow_1","makeStreamConfig_1","mapDataUsingRowHeights_1","padTableData_1","stringifyTableData_1","truncateTableData_1","utils_1","prepareData","data","config","rows","stringifyTableData","truncateTableData","extractTruncates","rowHeights","calculateRowHeights","mapDataUsingRowHeights","alignTableData","padTableData","create","row","columnWidths","body","map","literalRow","drawRow","join","output","drawBorderTop","drawBorderBottom","trimEnd","process","stdout","write","append","bottom","drawBorderJoin","createStream","userConfig","makeStreamConfig","Object","values","columns","column","width","paddingLeft","paddingRight","empty","length","columnCount","Error","exports"],"sources":["../../src/createStream.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}